<!DOCTYPE html><html lang="es"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><meta data-react-helmet="true" name="twitter:creator" content="@JoralmoPro"/><meta data-react-helmet="true" name="twitter:image:alt" content="Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para…"/><meta data-react-helmet="true" name="twitter:image" content="https://blog.joralmo.pro/banner.jpg"/><meta data-react-helmet="true" name="twitter:description" content="Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para…"/><meta data-react-helmet="true" name="twitter:url" content="https://blog.joralmo.pro/authentication-and-managing-roles-with-ruby-on-rails"/><meta data-react-helmet="true" name="twitter:title" content="Autenticación y manejo de roles con RubyOnRails"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:image:alt" content="Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://blog.joralmo.pro/banner.jpg"/><meta data-react-helmet="true" property="og:description" content="Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para…"/><meta data-react-helmet="true" property="og:url" content="https://blog.joralmo.pro/authentication-and-managing-roles-with-ruby-on-rails"/><meta data-react-helmet="true" property="og:title" content="Autenticación y manejo de roles con RubyOnRails"/><meta data-react-helmet="true" name="image" content="https://blog.joralmo.pro/banner.jpg"/><meta data-react-helmet="true" name="description" content="Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para…"/><meta name="generator" content="Gatsby 4.16.0"/><title data-react-helmet="true">Autenticación y manejo de roles con RubyOnRails | JoralmoPro</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&amp;display=swap"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="JoralmoPro" href="/rss.xml"/><link rel="preconnect" href="https://joralmo.matomo.cloud/"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1yc3m30">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default,.theme-ui-__default html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#9f7aea;--theme-ui-colors-secondary:#7f8ea3;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;}</style><style data-emotion="css-global 1j0yc2g">*{box-sizing:border-box;}html{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global h7esfd">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 10klvkd">.css-10klvkd{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-10klvkd"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="JoralmoPro - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 102q2va">.css-102q2va{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width: 640px){.css-102q2va{font-size:1.875rem;}}</style><div class="css-102q2va">JoralmoPro</div></a><style data-emotion="css zut31r">.css-zut31r{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-zut31r:hover,.css-zut31r:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-zut31r"><style data-emotion="css 1m6u41m">.css-1m6u41m{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon);}.css-1m6u41m:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0, 0);-moz-transform:translate(0, 0);-ms-transform:translate(0, 0);transform:translate(0, 0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1m6u41m:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-1m6u41m"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/blog">Blog</a><a class="css-bpdkdn" href="/about">Acerca de</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css 1fmmdck">.css-1fmmdck{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1fmmdck:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://twitter.com/JoralmoPro" class="css-1fmmdck">Twitter</a><a href="https://joralmo.pro" class="css-1fmmdck">Homepage</a></div></div></header><style data-emotion="css 1c3blfx">.css-1c3blfx [data-name='live-editor']{font-size:1rem;}.css-1c3blfx [data-name='live-editor'] textarea,.css-1c3blfx [data-name='live-editor'] pre{padding:1rem!important;}.css-1c3blfx [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-1c3blfx .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1c3blfx .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx .prism-code{font-size:1.25rem;}}.css-1c3blfx .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1c3blfx .gatsby-highlight[data-language=''] .prism-code,.css-1c3blfx .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1c3blfx .token{display:inline-block;}.css-1c3blfx p>code,.css-1c3blfx li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1c3blfx .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1c3blfx .gatsby-highlight pre code{float:left;min-width:100%;}.css-1c3blfx .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1c3blfx .gatsby-highlight pre[class~="language-javascript"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1c3blfx .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-py"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1c3blfx .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1c3blfx .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1c3blfx .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1c3blfx .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1c3blfx .gatsby-highlight pre[class~='language-json']:before,.css-1c3blfx .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1c3blfx .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1c3blfx .gatsby-highlight>code[class*="language-"],.css-1c3blfx .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-1c3blfx .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1c3blfx .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .token-line{padding-right:1rem;}.css-1c3blfx .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-1c3blfx .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1c3blfx .react-live-wrapper{position:relative;}.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:-1rem;}}</style><style data-emotion="css albdeh">.css-albdeh{box-sizing:border-box;margin:0;min-width:0;}.css-albdeh [data-name='live-editor']{font-size:1rem;}.css-albdeh [data-name='live-editor'] textarea,.css-albdeh [data-name='live-editor'] pre{padding:1rem!important;}.css-albdeh [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-albdeh .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-albdeh .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh .prism-code{font-size:1.25rem;}}.css-albdeh .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-albdeh .gatsby-highlight[data-language=''] .prism-code,.css-albdeh .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-albdeh .token{display:inline-block;}.css-albdeh p>code,.css-albdeh li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-albdeh .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-albdeh .gatsby-highlight pre code{float:left;min-width:100%;}.css-albdeh .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-albdeh .gatsby-highlight pre[class~="language-javascript"]:before,.css-albdeh .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-albdeh .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-py"]:before,.css-albdeh .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-albdeh .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-albdeh .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-albdeh .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-albdeh .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-albdeh .gatsby-highlight pre[class~='language-json']:before,.css-albdeh .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-albdeh .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-albdeh .gatsby-highlight>code[class*="language-"],.css-albdeh .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-albdeh .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-albdeh .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .token-line{padding-right:1rem;}.css-albdeh .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-albdeh .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-albdeh .react-live-wrapper{position:relative;}.css-albdeh .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-albdeh .react-live-wrapper .code-copy-button{right:-1rem;}}</style><main id="skip-nav" class=" css-albdeh"><style data-emotion="css 1aue9xx">.css-1aue9xx{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 768px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 1024px){.css-1aue9xx{font-size:4rem;}}</style><h1 class="css-1aue9xx">Autenticación y manejo de roles con RubyOnRails</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>11.04.2019</time> — <!-- --><a class="css-bpdkdn" href="/tags/ruby">ruby</a>, <!-- --><a class="css-bpdkdn" href="/tags/ruby-on-rails">ruby on rails</a>, <!-- --><a class="css-bpdkdn" href="/tags/jwt">jwt</a>, <!-- --><a class="css-bpdkdn" href="/tags/programacion">programación</a> — <!-- --><span>6<!-- --> min read<!-- --></span></p><style data-emotion="css b56ay0">.css-b56ay0{margin-top:4rem;margin-bottom:4rem;}.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0, 0, 0, 0.15) 0px 32px 32px 0px,rgba(0, 0, 0, 0.15) 0px 16px 16px 0px,rgba(0, 0, 0, 0.15) 0px 8px 8px 0px,rgba(0, 0, 0, 0.15) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-b56ay0"><style data-emotion="css i78tjp">.css-i78tjp{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading);margin-top:1rem;}@media screen and (min-width: 640px){.css-i78tjp{font-size:1.5rem;}}@media screen and (min-width: 768px){.css-i78tjp{font-size:1.5rem;}}@media screen and (min-width: 1024px){.css-i78tjp{font-size:1.875rem;}}</style><h4 class="css-i78tjp">Como dice en el titulo del post trataré de hacer un tutorial de como implementar un sistema autenticación y de roles utilizando ROR, para esto crearé un proyecto en el que hay usuarios de 3 tipos (administrador, usuario, visitante) y cada usuario tiene posts y será una pequeña API por lo que no tendrá nada en el front, para la autenticación utilizaré el estandar JWT (Json Web Token) con la gema <!-- --><style data-emotion="css 1bw77fa">.css-1bw77fa{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1bw77fa:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/jwt/ruby-jwt" class="css-1bw77fa">ruby-jwt</a>, y para el manejo de roles una librería de autorización que es la gema <!-- --><a href="https://github.com/CanCanCommunity/cancancan/" class="css-1bw77fa">cancancan</a>.<!-- --></h4><style data-emotion="css 1ccrm8j">.css-1ccrm8j{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-1ccrm8j{font-size:1rem;}}@media screen and (min-width: 768px){.css-1ccrm8j{font-size:1.25rem;}}</style><p class="css-1ccrm8j">Y bueno empecemos, asumo que tienes rails y ruby instalado en tu pc, para este tutorial he utilizado las versiones:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><style data-emotion="css dybovu">.css-dybovu{background-color:rgba(107,70,193,0.2);border:none;color:var(--theme-ui-colors-gray-2);cursor:pointer;font-size:14px;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-dybovu{font-size:14px;}}@media screen and (min-width: 768px){.css-dybovu{font-size:16px;}}.css-dybovu[disabled]{cursor:not-allowed;}.css-dybovu:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">$ ruby -v</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> ruby </span><span class="token number" style="color:rgb(247, 140, 108)">2.6</span><span class="token plain">.1p33 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2019</span><span class="token plain">-01-30 revision </span><span class="token number" style="color:rgb(247, 140, 108)">66950</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">x86_64-linux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">$ rails -v</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> Rails </span><span class="token number" style="color:rgb(247, 140, 108)">5.2</span><span class="token plain">.3</span></div></code></pre></div><p class="css-1ccrm8j">Lo primero que debemos hacer es crear el proyecto con <!-- --><code class="css-0">rails new authTutorial</code></p><p class="css-1ccrm8j">Siguiente a esto creamos los modelos</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">rails g model Rol nombre:string</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  rails g model Usuario correo:string password_digest:string rol:references</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">  rails g model Post titulo:string contenido:string usuario:references</span></div></code></pre></div><style data-emotion="css 1ioa6cd">.css-1ioa6cd{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:6px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1ioa6cd p{font-style:italic;}</style><blockquote class="css-1ioa6cd"><p class="css-1ccrm8j">Importante el atributo password_digest que es el que le indica a rails que debe encriptar la contraseña al momento del registro.</p></blockquote><blockquote class="css-1ioa6cd"><p class="css-1ccrm8j">Importante crearlos en este orden para que no haya problemas al momento de migrar la base de datos.</p></blockquote><p class="css-1ccrm8j">Los anteriores comandos nos generarán tres modelos y tres migraciones.</p><p class="css-1ccrm8j">Ahora debemos ir al modelo de usuarios en app/models/usuario.rb y decirle a rails que es un modelo al cual le debe encriptar la contraseña agregandole has_secure_password</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Usuario &lt; ApplicationRecord</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  has_secure_password</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">  belongs_to :rol</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">El <!-- --><code class="css-0">belogns_to</code> se agrega automaticamente al momento de crear el modelo con el generador<!-- --></p><p class="css-1ccrm8j">Lo que haremos ahora será configurar nuestra base de datos en /config/database.yml en el cual para este tutorial yo utilizaré la gema mysql2, por lo tanto en el Gemfile reemplazaré sqlite3 por mysql2</p><p class="css-1ccrm8j">database.yml</p><div class="gatsby-highlight" data-language="yaml"><pre class="prism-code language-yaml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-yaml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token key atrule">default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token important">&amp;default</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  </span><span class="token key atrule">adapter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mysql2</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">  </span><span class="token key atrule">pool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;%= ENV.fetch(&quot;RAILS_MAX_THREADS&quot;) </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> %</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">  </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5000</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain"></span><span class="token key atrule">development</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> authTutorial</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tutorial</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> JoralmoPro</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">  </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain"></span><span class="token key atrule">test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#database: db/test.sqlite3</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain"></span><span class="token key atrule">production</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain">  </span><span class="token key atrule">&lt;&lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token important">*default</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#database: db/production.sqlite3</span></div></code></pre></div><p class="css-1ccrm8j">Una vez terminado con este archivo, pasamos al seed (ahora explico porque he comentado las bases de datos de los otros dos enviroments).</p><p class="css-1ccrm8j">En el seed vamos a crear unos cuantos datos para la base de datos, utilizaré faker para estó, por lo tanto en el Gemfile toca agregar <!-- --><code class="css-0">gem&#x27;faker&#x27;</code> por lo menos yo lo he agregado solamente para el grupo de development y test, adicionalmente descomentar <!-- --><code class="css-0">gem &#x27;bcrypt&#x27;</code> para la contraseña del usuario, luego hacemos <!-- --><code class="css-0">bundle install</code></p><p class="css-1ccrm8j">Una vez agregada la gema vamos al archivo db/seeds.rb</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">administrador = Rol.create(nombre: &quot;administrador&quot;)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">cliente = Rol.create(nombre: &quot;cliente&quot;)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">visitante = Rol.create(nombre: &quot;visitante&quot;)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">Usuario.create(correo: &quot;joralmopro@gmail.com&quot;, password: &quot;123456&quot;, rol: administrador)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">5.times do</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">    usuario = Usuario.create(correo: Faker::Internet.email, password: &quot;cliente&quot;, rol: cliente)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">    Post.create(titulo: Faker::Book.title, contenido: Faker::Lorem.paragraph, usuario: usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">p &quot;#{Usuario.count} usuarios creados&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">p &quot;#{Rol.count} roles creados&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">p &quot;#{Post.count} post creados&quot;</span></div></code></pre></div><p class="css-1ccrm8j">Esto creará los tres roles mencionados al principio, un usuario administrador y 5 usuarios normales y al final nos mostrará en consola cuantas entidades a creado de cada modelo.</p><p class="css-1ccrm8j">Teniendo ya esto listo procedemos a ejecutar en la consola</p><p class="css-1ccrm8j"><code class="css-0">rails db:create; and rails db:migrate; and rails db:seed</code> <!-- --><strong class="css-0">(Yo uso fish en ubuntu, si usas bash normal reemplazar los ; and por &amp;&amp;)</strong></p><p class="css-1ccrm8j">El anterior comando es el motivo por el que he comentado las bases de datos de los otros dos enviromentes pues al hacer db:create intentará crear las bases de datos y dará error pues no tengo sqlite3, en caso de necesitarlas solo escribes en consola <!-- --><code class="css-0">rails db:environment:set RAILS_ENV=development</code> para que siempre utilice el enviroment development.<!-- --></p><p class="css-1ccrm8j">Despues de ejecutar el comando anterior deberas ver algo como esto en la consola</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">Created database </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;authTutorial&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210050</span><span class="token plain"> CreateRols: migrating </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">-- create_table</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">:rols</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">   -</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.2598s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210050</span><span class="token plain"> CreateRols: migrated </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.2599s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210141</span><span class="token plain"> CreateUsuarios: migrating </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">-- create_table</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">:usuarios</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">   -</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.3437s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210141</span><span class="token plain"> CreateUsuarios: migrated </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.3438s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210248</span><span class="token plain"> CreatePosts: migrating </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">-- create_table</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">:posts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">   -</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.3559s</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20190411210248</span><span class="token plain"> CreatePosts: migrated </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">.3560s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain"></span><span class="token string" style="color:rgb(173, 219, 103)">&quot;6 usuarios creados&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain"></span><span class="token string" style="color:rgb(173, 219, 103)">&quot;3 roles creados&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain"></span><span class="token string" style="color:rgb(173, 219, 103)">&quot;5 post creados&quot;</span></div></code></pre></div><p class="css-1ccrm8j">Y hasta ahora todo bien, todo correcto :v</p><p class="css-1ccrm8j">Pero empecemos con lo más interesante, vamos con la autenticación, para esto es necesario primero que todo incluir en el Gemfile dos gemas:</p><style data-emotion="css 15rlv7r">.css-15rlv7r li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15rlv7r li{font-size:1.25rem;}}</style><ol class="css-15rlv7r"><li class="css-0"><code class="css-0">gem &#x27;jwt&#x27;</code></li><li class="css-0"><code class="css-0">gem &#x27;dotenv-rails&#x27;</code></li></ol><p class="css-1ccrm8j">la primera es para jwt y la segunda es para poder utilizar el archivo .env que es donde colocaremos la key necesaria para el jwt, no olvidar el <!-- --><code class="css-0">bundle install</code> y luego en la raiz del proyecto crear el archivo <!-- --><code class="css-0">.env</code> y agregar <!-- --><code class="css-0">JWT_SECRET=&#x27;l4m3j0rc14v3d31mund0&#x27;</code> donde la clave puede ser lo que quieras.<!-- --></p><p class="css-1ccrm8j">Continuamos ahora creando en /app una carpeta llamada jwt y dentro el archivo json_web_token.rb que es donde tendremos la clase JsonWebToken, el archivo contendra lo siguiente</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class JsonWebToken</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    JWT_SECRET = ENV[&quot;JWT_SECRET&quot;]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    def self.encode(payload, exp = 24.hours.from_now)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">        payload[:exp] = exp.to_i</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">        JWT.encode(payload, JWT_SECRET)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">    def self.decode(token)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">        body = JWT.decode(token, JWT_SECRET)[0]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">        HashWithIndifferentAccess.new body</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">    rescue JWT::ExpiredSignature, JWT::VerificationError =&gt; e</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">        raise ManejadorDeExcepciones::TokenExpirado, e.message</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">    rescue JWT::DecodeError, JWT::VerificationError =&gt; e</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">        raise ManejadorDeExcepciones::TokenNoValido, e.message</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Dos funciones, <!-- --><code class="css-0">encode</code> y <!-- --><code class="css-0">decode</code>.<!-- --></p><p class="css-1ccrm8j">La primera recibe dos parametros (aunque el segundo puede ser vacio y por defecto le pondrá 24 horas), y crea el token.</p><p class="css-1ccrm8j">La segunda solo recibe como parametro un token y lo decodifica, luego se hace un rescue para manejar los errores en caso de que el token haya vencido o no sea valido, este manejador de errores lo crearemos a continuación, por lo tanto procedemos a crear un archivo en app/controllers/concerns/manejador_de_excepciones.rb</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">module ManejadorDeExcepciones extend ActiveSupport::Concern</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    class TokenNoValido &lt; StandardError; end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    class TokenExpirado &lt; StandardError; end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">    included do</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">        rescue_from ManejadorDeExcepciones::TokenNoValido do |_error|</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">            render json: {mensaje: &quot;¡Acceso denegado!. Token inválido suministrado.&quot;}, status: :unauthorized</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">        rescue_from ManejadorDeExcepciones::TokenExpirado do |_error|</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">            render json: {mensaje: &quot;¡Acceso denegado!. Token expirado&quot;}, status: :unauthorized</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Esté archivo recibira los errores de la clase JWT y los manejará para devolver el mensaje de error, ahora tenemos que incluirlo en el appliation_controller para poder utilizarlo en las demás clases</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class ApplicationController &lt; ActionController::Base</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    include ManejadorDeExcepciones</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Ahora procedemos a crear una carpeta llamada auth (o como quieran) dentro de app y dentro un archivo authentication.rb que es donde estará la clase Authentication que será la encargada de autenticar al usuario y generar el token, esperemos que se entienda con solo verla.</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Authentication</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    def initialize(usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">        @correo = usuario[:correo]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">        @password = usuario[:password]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">        @usuario = Usuario.find_by(correo: @correo)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">    def autenticar</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">        @usuario &amp;&amp; @usuario.authenticate(@password)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">    def generar_token</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">        JsonWebToken.encode({usuario_id: @usuario.id, correo: @usuario.correo})</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">teniendo esto, esperariamos que nuestra autenticación ya funcionara, entonces la probamos creando una ruta al controlador de sesión en config/routes.rb (como estoy manejando las carpetas ap1 y v1 en mi proyecto colocaré los namespace, si quieres los puedes obviar)</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">Rails.application.routes.draw do</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  namespace :api do</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    namespace :v1 do</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">      post &#x27;login&#x27;, to: &#x27;session#login&#x27;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Ahora creamos los controladores para ir probando que todo funciona hasta aquí, quedaría algo así (obviar las carpetas api y v1 si lo deseas)</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:264px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:63.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMUlEQVQoz5WR207DMBBE/SUgiNd2YsfxPY6dS9PQNqhqxf9/DYrgkUIYzcNqpaPZ1SCeNDs7kz1hDGMAIPuNhKyH2Kno1OBoWf6LR2VZrYOzyTXZyWiAUMC7YS7q62yVVzI7PQVu5P5wVFX8dkk2GdGaOmhuJOyHCZTj0c9r4F5DAbiA7XJCvv07DEBUXd8vSWj5tdp4vDeZvFK2VvSouBhDHVSTnRpbPXjuGvxHMsZPGNbi5SRomawMivtGRi07I7yijBZFgR8IaWVZ4z6kvHnj35d8nuM8psucr29pPfo+NY1Vyv1oZEwbYroHs8TQnpc4Ty4l32ff96HPNnZah0dGmLAp1FOvWLSqt1vPBd5eohQowQD4sdAzkBPgtSRy6fTo9dTK1mzDIZpDK7z6pfZPcMmEMGmipyUAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="controladores" title="controladores" src="/static/8c860e0571326e6946d4d817247579b7/96573/controladores.png" srcSet="/static/8c860e0571326e6946d4d817247579b7/5243c/controladores.png 240w,/static/8c860e0571326e6946d4d817247579b7/96573/controladores.png 264w" sizes="(max-width: 264px) 100vw, 264px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">y en session_controller</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Api::V1::SessionController &lt; ApplicationController</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    def login</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">        auth = Authentication.new(login_params)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">        if(auth.autenticar)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">            render json: {mensaje: &quot;¡Inicio de sesión correcto!&quot;, token: auth.generar_token}, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">        else</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">            render json: {mensaje: &quot;Correo o Contraseña incorrectos&quot;}, status: :unauthorized</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">    private</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">    def login_params</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">        params.permit(:correo, :password)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">y luego para poder probar, ruby espera un csrf_token en cada solicitud pero aquí no lo utilizaremos por lo que nos toca deshabilitarlo agregando en application_controller <!-- --><code class="css-0">protect_from_forgery with: :null_session</code> y ahora si podremos probar (en mi caso lo haré con postman y enviando el usuario que he creado en el seed como admin)<!-- --></p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:44.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQoz52Qa0oFMQyFuzs36E8XI7gJV+DVmU7bSZvm0Uek94r6QxE8fBxOIBxIXIwxhBBj9P7Y9mP3PoQAACcAQL7yoZhOPMP9E9w9pMfnRBBcrZWoVqqIJflXzICITCRclUlF9JtE5ER9PbWQKqGDnEvGUjglzlCZmUVZtHFthE2lD+tjfjLnNJtjruz8cdRMCJKSVbI2rE/rN7+F33ExxmvZf+Rywd56770tH1f+kLa13PpwJWyIhQixYqVKeK47V9/PiAiSEEup5A6/nSEFX/zO+0ZhQ+HeurW2UP0KtzyGTVsvVFW37TtmOrZ+ebHLi71dLIOVYgCLnA3yh6+xGItpX7Rh742yCi/93ieCAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="primerPruebaLogin" title="primerPruebaLogin" src="/static/e37bfc860b0848e92ca390c98938bbe1/7d769/primerPruebaLogin.png" srcSet="/static/e37bfc860b0848e92ca390c98938bbe1/5243c/primerPruebaLogin.png 240w,/static/e37bfc860b0848e92ca390c98938bbe1/ab158/primerPruebaLogin.png 480w,/static/e37bfc860b0848e92ca390c98938bbe1/7d769/primerPruebaLogin.png 960w,/static/e37bfc860b0848e92ca390c98938bbe1/977c6/primerPruebaLogin.png 1051w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">¡Y hasta aquí todo está funcionando correctamente!</p><p class="css-1ccrm8j">pero hasta este punto todo el mundo puede hacer lo que le de la gana despues de haber obtenido el token, hasta un visitante podría eliminar o actualizar algo (en caso de tener creados los metodos en los controladores) y es cuando entra en juego la gema cancancan que es la que nos permitirá gestionar que permisos tiene cada usuario dependiendo de su rol, y lo hace de una manera muy elegante, lo primero entonces es instalarla agregando <!-- --><code class="css-0">gem &#x27;cancancan&#x27;</code> en el Gemfile y luego como no ejecutar <!-- --><code class="css-0">bundle install</code>, a continuación despues de instalada debemos ejecutar en consola <!-- --><code class="css-0">rails g cancan:ability</code>  para que se cree el archivo ability.rb dentro de la carpeta app/models/, si da error pues lo crear manual xD.<!-- --></p><p class="css-1ccrm8j">Una vez ubicado el archivo vemos que tiene la clase Ability creada y el inicializador de está misma, como nuestro proyecto tiene 3 roles lo que haremos es que cada vez que soliciten autorización les devolveremos una función dependiendo del rol del usuario para saber que puede hacer y que no, así:</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Ability</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  include CanCan::Ability</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">  def initialize(usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">    send(&quot;#{usuario.rol.nombre}_permisos&quot;, usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">  def administrador_permisos(usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">    can :manage, :all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">  </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">  def cliente_permisos(usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">    can :read, Post, :all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">    can :manage, Post, { usuario_id: usuario.id}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">    can [:read, :update], Usuario, { id: usuario.id }</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">  def visitante_permisos(usuario)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain">    can :read, Post, :all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22<!-- --></span><span class="token plain">  def lista_de_permisos</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23<!-- --></span><span class="token plain">    rules.map do |rule|</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24<!-- --></span><span class="token plain">     object = { acciones: rule.actions, sobre: rule.subjects.map{ |s| s.is_a?(Symbol) ? s : s.name } }</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25<!-- --></span><span class="token plain">      object[:condiciones] = rule.conditions unless rule.conditions.blank?</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26<!-- --></span><span class="token plain">      object[:inverted] = true unless rule.base_behavior</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27<!-- --></span><span class="token plain">      object</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29<!-- --></span><span class="token plain">  end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Vemos  tres funciones una por cada rol, y lo que dice dentro de cada una es que el administrador puede hacer de todo, el cliente puede leer todos los post pero solo puede actualizar, crear, eliminar y borrar post que le pertenezcan a el y además solo podra ver y actualizar un usuario si es el mismo, en cuando al visitante solamente puede leer todos los post, esto es maravilloso nos ahorramos hacer un monton de if (que yo habría hecho si esta gema no existiera xD) en cada controlador dependiendo del rol del usuario; tambien vemos un metodo llamado lista_de_permisos que este lo que nos retorna es que puede hacer cada rol, ahora lo vemos.</p><p class="css-1ccrm8j">Para probarlo en el controlador de usuarios escribiremos los siguientes metodos</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Api::V1::UsuariosController &lt; ApplicationController</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    def index</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">        usuarios = Usuario.all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">        render json: usuarios, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">    def create</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">        usuario = Usuario.new(usuario_params)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">        if usuario.save</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">            render json: usuario, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">        else</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">            render json: &quot;error&quot;, status: :unprocessable_entity</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain">    def show</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain">        usuario = Usuario.find(params[:id])</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">        permisos = Ability.new(usuario).lista_de_permisos</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain">        render json: {usuario: usuario, permisos: permisos}, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22<!-- --></span><span class="token plain">    private</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23<!-- --></span><span class="token plain">    def usuario_params</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24<!-- --></span><span class="token plain">        params.permit(:correo, :password, :rol_id)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Y desde postman probamos con el usuario 1 que es el admin</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:844px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:49.583333333333336%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVQoz5WQ61LDIBBG8/4P6D911No0VxLugYbjQNqq1bGVnTMfl92PhUqIkbZtEULQNA2Hw4G6rotmhmFgmqab9H1ffCrnPNZanHNFjcmYMj+Tz25xzq1U84IzCmsdzlqUdHgXsNaUdYyREMJNcl6mGvqutCuVKq0rLZnljJKCRY4kIKV0N1XXddsTR4mRlhhgsSsxFKst1n8Y5o8PMWL7mcPDK+PO0D5B8wjtc0KPCTtzQY9gpsR6zBf+HMUwf6buZ1Qz4nVEi61obhPHsBWm7fEXSvzW4X7/XgzjElC9RovlVMRFt+Rrvd7bqOp6z7J4YMUIi9fHk9d300/9e1S73Rti0li/skQKPiR8+Kr38wGIvAxTNrSlnwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="lista de permisos admin" title="lista de permisos admin" src="/static/669e65972c014ff0373378857204b463/b4e2e/lista_de_permisos_admin.png" srcSet="/static/669e65972c014ff0373378857204b463/5243c/lista_de_permisos_admin.png 240w,/static/669e65972c014ff0373378857204b463/ab158/lista_de_permisos_admin.png 480w,/static/669e65972c014ff0373378857204b463/b4e2e/lista_de_permisos_admin.png 844w" sizes="(max-width: 844px) 100vw, 844px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">Con el usuario 2 que es un usuario normal (cliente)</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:846px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:63.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHUlEQVQ4y6WTyXLCMBBE9f8/mQNgMBK2rB3J1kt5SYBLWDJVXTpMTatb0xJdr5FS0fc9bdtyOp1uaFuklPRaL/2/oJRa5oU+fqE7hXEOrTXDMCwEg9Y43RFjIqXniDESQkAo2S43DJ3GGENMEeccwTuK18xVa32KnxLN8UjwgewT/mJJ7vrbrC+S3UM0TbNInset8kRb7ul4t8Rut8NYT0yZYK8EV8ilUkYoY30bG2Egj5WusXTnzFghFxbi9Xwdq+UYV8tywJ0NJeePbYvD4UAIkVIKOSSuLlByYV7c7bF5GaJpVkKYcJeEUWWLCg9xeFnhbDlulofWYmR+OyoPsdnv94vCqU6E3uI7xzRNfFpi/qveB8ZxpG4L+I/Cb9ZY+1JdBwjyAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="lista de permisos cliente" title="lista de permisos cliente" src="/static/7795c527bf04bb5975620e710ec9a421/ccfff/lista_de_permisos_cliente.png" srcSet="/static/7795c527bf04bb5975620e710ec9a421/5243c/lista_de_permisos_cliente.png 240w,/static/7795c527bf04bb5975620e710ec9a421/ab158/lista_de_permisos_cliente.png 480w,/static/7795c527bf04bb5975620e710ec9a421/ccfff/lista_de_permisos_cliente.png 846w" sizes="(max-width: 846px) 100vw, 846px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">y vemos que por cada petición nos retorna los permisos del usuario, las acciones que puede hacer,  sobre que modelo y si tiene alguna condición para poder hacer esa acción, quizá para algo puede servir esté metodo en algun momento.</p><p class="css-1ccrm8j">Pero continuemos con el proceso, ahora para que cancancan pueda saber que hacer al momento de hacer una petición a algún controlador donde definamos la autorización el asume que tenemos la clase ability (que ya la tenemos en la carpeta app/models) y tambien un metodo llamado current_user y por lo tanto este metodo es el que procederemos a escribir ahora, entonces nos vamos a app/controllers/application_controller.rb y es aquí donde escribiremos el metodo para poder tenerlo disponible en toda la aplicación quedando así</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class ApplicationController &lt; ActionController::Base</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    protect_from_forgery with: :null_session</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    include ManejadorDeExcepciones</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">    rescue_from CanCan::AccessDenied do |exception|</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">        render json: { mensaje: exception.message }, status: 403</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">    def current_user</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">        if token</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">            @usuario_actual ||= Usuario.find(token[:usuario_id])</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">        else</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">            @usuario_actual ||= Usuario.new(rol_id: 3)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain">    private</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">    def token</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain">        valor = request.headers[:Authorization]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20<!-- --></span><span class="token plain">        return if valor.blank?</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21<!-- --></span><span class="token plain">        @token ||= JsonWebToken.decode(valor.split(&quot; &quot;).last)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Lo que agregamos ahora es un rescue para manejar el error cuando el acceso sea denegado y devolver un error de no autorizado, el metodo current user que recupera el usuario actual dependiendo del token que venga en la solicitud y en caso de no haber ningun token se tomará como usuario visitante por eso se le asigna el rol tres (asumo que el rol con id tres es el visitante, lo pueden hacer dinamico con una consulta a la tabla rols).</p><p class="css-1ccrm8j">Luego de esto volvemos el metodo show el usuarios_controller normal y le agregamos la directiva para que cancancan aplique la autorización en esa clase, así</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class Api::V1::UsuariosController &lt; ApplicationController</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    load_and_authorize_resource class: &quot;Usuario&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">    def index</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain">        usuarios = Usuario.all</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">        render json: usuarios, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain">    def create</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">        usuario = Usuario.new(usuario_params)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">        if usuario.save</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">            render json: usuario, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">        else</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">            render json: &quot;error&quot;, status: :unprocessable_entity</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">    def show</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain">        usuario = Usuario.find(params[:id])</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20<!-- --></span><span class="token plain">        render json: usuario, status: :ok</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23<!-- --></span><span class="token plain">    private</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24<!-- --></span><span class="token plain">    def usuario_params</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25<!-- --></span><span class="token plain">        params.permit(:correo, :password, :rol_id)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Y probamos!</p><p class="css-1ccrm8j">Pedimos el usuario con id 3 y enviamos el token del administrador, y lo devolverá sin problemas pues el puede realizar está acción</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:845px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:50%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQoz32R61LkIBBG8/6vuPtjtjQ6uQ0EkuYajgVRyxl1qTr1QV9p6JRSTOOI1pppmhmGgev12rSyLEvz/UbNP3Mn5nmms9ZirMWaFb3M6JvCGNNY15Xq3/edbdua/oSItLhKF2NAnCM5yzY+EYwi50xKiRAC3ntEXLP9RIyxNa96HAdd3/dopRDnKXBSyic1aLMrsm/knO58H/7avGo9d8MwttHqtauxlrxLqgliyM5SasGHho90QTbq2PXKFZFADLmNGkJ8tydSyp8xj5yxZ41Ov15Yb3P7GGNWrLGsxmJXjavveRRySuSUf33Hr3TLTaGURnZBxOPk/IQYHUcUzlXu+O/I4zTi7c7yp0c/G1RfmP+BvsKuwNuCM6Wp6HN/pPKtyQdd//KCulmmy8zyahl7GJ4Kz38Ly1hwviAC4mB/VxcKPoIP33kDCs0KJX6Yr7oAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="autorizacion admin" title="autorizacion admin" src="/static/e2d2357da4b9c6b051c136b8c256afed/9e11f/autorizacion_admin.png" srcSet="/static/e2d2357da4b9c6b051c136b8c256afed/5243c/autorizacion_admin.png 240w,/static/e2d2357da4b9c6b051c136b8c256afed/ab158/autorizacion_admin.png 480w,/static/e2d2357da4b9c6b051c136b8c256afed/9e11f/autorizacion_admin.png 845w" sizes="(max-width: 845px) 100vw, 845px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">pero si lo hacemos con el token de un usuario normal</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:847px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:42.91666666666667%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQoz41S2Y7DIAzk/z9zX5qkm3DYkGCOWZk2q2ylqmtpZHwNtsHM8wxrLe73O6Zpwu12G5imGcuyjNh/oDzrusKEEMBEcHaDsw4heHgf4L2HxmKMYOah3yGlBCIaeSbtO8rBoPkL+7qgFkEpFcdxDGhyzhm1VpRS/kB9mqNkp220XS1qraH3PvR5VkkxgiiMwmv8zFEivfD0DUJtW42H9Kd66CY7SgpoOf76rtJffEa0fZHRrkgZ4+qt8hxLRFcgqC/jlktcOzxtQ/YbPBZPCF4fKIEjIZJDKbq7s1je4EKeM4x+F7d5bJuHswy7EbaVwOuKvOt+OkQaauuo9TOM84wUMiI3RAI4AOwBJoA8EFxDTAW5AIf0j/gBZsK9H6k/yr8AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="autorizacion usuario normal" title="autorizacion usuario normal" src="/static/c492a0193307f863484bf85188f7836b/44c02/autorizacion_usuario_normal.png" srcSet="/static/c492a0193307f863484bf85188f7836b/5243c/autorizacion_usuario_normal.png 240w,/static/c492a0193307f863484bf85188f7836b/ab158/autorizacion_usuario_normal.png 480w,/static/c492a0193307f863484bf85188f7836b/44c02/autorizacion_usuario_normal.png 847w" sizes="(max-width: 847px) 100vw, 847px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">igual sucede con el usuario visitante</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:850px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:43.333333333333336%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQoz4WRWW7DMAwFff9j9iupV62WqGUKKnECFEVjYPC4iiQ8zfPMvu/M39/cbzduT+73O8uycBzHR7Rf6621TMYYnPfsxnIYh/qKFqp673HODf2LEMJAa1WnMyUkWuzti7SvlCKUUkgpDc7zRESotY74b7QmxvjKT4cxnDHQ5aSXRGtt0JXex3Z6QRYZ/pVvz3zOeQy9YpOeFmKkd55ff6laLQdqtEOv2FXT300ve9LJj5MKInrGY3W5VDK1yOCvk7VXtxy+CJM329jQB4c1juAjITiiOyj1Mej9gPxDIaeTaZkXjs2wrQZzeLbVsq2OsK5IauTUKLVRW6fWD7SuPyUQbSb4RvDgLTgD3j1ss1diqmSBJP0jP7WXvT7g5tjVAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="autorizacion visitante" title="autorizacion visitante" src="/static/64bd8d3561e6db83dc2af514d22b2677/f20d0/autorizacion_visitante.png" srcSet="/static/64bd8d3561e6db83dc2af514d22b2677/5243c/autorizacion_visitante.png 240w,/static/64bd8d3561e6db83dc2af514d22b2677/ab158/autorizacion_visitante.png 480w,/static/64bd8d3561e6db83dc2af514d22b2677/f20d0/autorizacion_visitante.png 850w" sizes="(max-width: 850px) 100vw, 850px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">El enviroment en postman contiene los tokens (el del visitante simplemente no es nada)</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:663px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:12.5%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUElEQVQI143MQQoAIQhA0e5/WEuzxIU6KDSrgUZ4CIW/7b1jjBEiEjnu/snMAhELALx67yUbuZuqBjP/Cs45ywkfRFTvudtaq8r5kUe36M0D8+XqZKgNDoMAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="enviroment postman" title="enviroment postman" src="/static/b03688f342afb513554c423154209563/28b9b/enviroment_postman.png" srcSet="/static/b03688f342afb513554c423154209563/5243c/enviroment_postman.png 240w,/static/b03688f342afb513554c423154209563/ab158/enviroment_postman.png 480w,/static/b03688f342afb513554c423154209563/28b9b/enviroment_postman.png 663w" sizes="(max-width: 663px) 100vw, 663px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">Y con estás pruebas podemos ver que todo está funcionando correctamente!, ahora simplemente por deseo personal me gustaría ver el mensaje de error en español y de forma personalizada, por lo que toca hacer lo siguiente, en config/locales/ crearé el archivo es.yml y tendrá lo siguiente</p><div class="gatsby-highlight" data-language="yaml"><pre class="prism-code language-yaml" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-yaml"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token key atrule">es</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">  </span><span class="token key atrule">unauthorized</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    </span><span class="token key atrule">manage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">      </span><span class="token key atrule">all</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;No estás autorizado para: [%{action}] =&gt; [%{subject}].&quot;</span></div></code></pre></div><p class="css-1ccrm8j">además de esto en application_controller agregamos un before_action y le pasamos una función para cambiar el locale de rails, quedaría así</p><div class="gatsby-highlight" data-language="ruby"><pre class="prism-code language-ruby" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<!-- --><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-ruby"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1<!-- --></span><span class="token plain">class ApplicationController &lt; ActionController::Base</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2<!-- --></span><span class="token plain">    before_action :set_locale</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3<!-- --></span><span class="token plain">    protect_from_forgery with: :null_session</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4<!-- --></span><span class="token plain">    include ManejadorDeExcepciones</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6<!-- --></span><span class="token plain">    rescue_from CanCan::AccessDenied do |exception|</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7<!-- --></span><span class="token plain">        render json: { mensaje: exception.message }, status: 403</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10<!-- --></span><span class="token plain">    def current_user</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11<!-- --></span><span class="token plain">        if token</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12<!-- --></span><span class="token plain">            @usuario_actual ||= Usuario.find(token[:usuario_id])</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13<!-- --></span><span class="token plain">        else</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14<!-- --></span><span class="token plain">            @usuario_actual ||= Usuario.new(rol_id: 3)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15<!-- --></span><span class="token plain">        end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17<!-- --></span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18<!-- --></span><span class="token plain">    private</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19<!-- --></span><span class="token plain">    def token</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20<!-- --></span><span class="token plain">        valor = request.headers[:Authorization]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21<!-- --></span><span class="token plain">        return if valor.blank?</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22<!-- --></span><span class="token plain">        @token ||= JsonWebToken.decode(valor.split(&quot; &quot;).last)</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24<!-- --></span><span class="token plain">    def set_locale</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25<!-- --></span><span class="token plain">        I18n.locale = &quot;es&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26<!-- --></span><span class="token plain">    end</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27<!-- --></span><span class="token plain">end</span></div></code></pre></div><p class="css-1ccrm8j">Haremos otra prueba y veremos los errores, en este caso trataremos de crear un nuevo usuario</p><p class="css-1ccrm8j">Token de visitante</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:853px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:60.416666666666664%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9UlEQVQoz7XSf0vEMAyA4X7/L+k/aq/n2q1b2q4/1le2O1FBvMPDwENCKCGUKOccxhj87Dm/GYzRaP3K6aSP/jg6pmm8yZjTkdVpL5zHvQxYkzg/F7zLxJRJa2G90/E2V5TWmmWJiA2EZSMGKA3qHylrLbVWPqM/RA3DQCnlMqp3ev+aP+r7/TDwMf8z8PsfPhbK+4mc87HlLqU9V9acydfefSpriiivnxDvkBAQmZFFEBGCeHJc2LZG2yqt3dIoeUW9DQPWjkxuxjlhGiPOBmYnhCmQV1hjp9RObb9rG5fDFknkuK/cj8NOV/HQCUsn58vQW94BtI+shLOVrL8AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="crear usuario visitante" title="crear usuario visitante" src="/static/6256be829877f9b37f3f966ce51f823f/6fbab/crear_usuario_visitante.png" srcSet="/static/6256be829877f9b37f3f966ce51f823f/5243c/crear_usuario_visitante.png 240w,/static/6256be829877f9b37f3f966ce51f823f/ab158/crear_usuario_visitante.png 480w,/static/6256be829877f9b37f3f966ce51f823f/6fbab/crear_usuario_visitante.png 853w" sizes="(max-width: 853px) 100vw, 853px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">Token usuario</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:841px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:47.91666666666667%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz42S627DIAyFef+33J82TdIEMOGOz2TSpNXaTUP6BDb4gE+ihmHAsiwYxxuu10vn0ucB0zRhXdc/kVrhdrthHEcoIsK2eVjaOhJbQ33e97YT7/1HQghwznVUiBHZE+zwhXAfEX3A5jJyTv2gkFJCzhmllDckH2M8Y2UtIcUAzhFcIrg1MDe01iBDXkZuQ86l515h5i4onYiYxGqeZxA51NrAQE9y4y7KDJTokdyK4u0jx2/gqBNBUT5u28cx7yt5MbjKAuDn3nnmh7DKj95rrb2tkuvuzYtHPV/qrx4eHgvKLlP3yDmC0RZEHuQIzur+YUqVwnwWvPO8PMYEtdxnkDEw2sAa138ZowlR31FTQatAK3wY8Bl+AIYaZ43NJJCpsBow6461gOkxw2hGSP/jGyk1DHTtoh8lAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="crear usuario usuario" title="crear usuario usuario" src="/static/018cdd6136538501a7a5d23a099a2a40/20595/crear_usuario_usuario.png" srcSet="/static/018cdd6136538501a7a5d23a099a2a40/5243c/crear_usuario_usuario.png 240w,/static/018cdd6136538501a7a5d23a099a2a40/ab158/crear_usuario_usuario.png 480w,/static/018cdd6136538501a7a5d23a099a2a40/20595/crear_usuario_usuario.png 841w" sizes="(max-width: 841px) 100vw, 841px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">Y por ultimo con el administrador</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:850px">
      <!-- --><span class="gatsby-resp-image-background-image" style="padding-bottom:55.41666666666667%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQoz32S7W6cMBBFef8H7L8qqtossIsNNrbx94lsomySzdbS0Zi5M8bcYVjXlev1ipSS5XZjniemaWKe54/8tm1Paf0t3m43lmVh2PcdrRTGWJQ2J0qhNo3WmqZbazHG9PgTzrle1xhCCPgQiG5Hz385VoH3HmcTPniO4+jPMUZSSg+0/Gd9EEIg5UrwByUe1BQopVBro5JzRimNcwcp5a59puntZu3AVj9cLheEWHDHQS6VCl24U8jekJym5PiD3jLn6gemXEg59zedYn1oqCVByR+3/s75Red+MEoSDkfzMsaAs57gc/elexsjIcQen9F6w3vtoOc/KDGzG4PWqvuh9Y7RCq/l6VXOXynPGcS6IcSKNQ7rAtYEjPF9wjE4cqF7+1/yfT+M48i27Yy/XplfJNNLYfwN138gr7CJyrrUHhtKVqythFQJ8ZGh/eHWGuy0YuXOvsC+VORrxazvQyp8Ae6T/b7eAKGiWR33JG6LAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <!-- --><img class="gatsby-resp-image-image css-0" alt="crear usuario admin" title="crear usuario admin" src="/static/5134a859cb49a872f4a4fc0b2649a01f/f20d0/crear_usuario_admin.png" srcSet="/static/5134a859cb49a872f4a4fc0b2649a01f/5243c/crear_usuario_admin.png 240w,/static/5134a859cb49a872f4a4fc0b2649a01f/ab158/crear_usuario_admin.png 480w,/static/5134a859cb49a872f4a4fc0b2649a01f/f20d0/crear_usuario_admin.png 850w" sizes="(max-width: 850px) 100vw, 850px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    <!-- --></span></p><p class="css-1ccrm8j">Y así mismo pasaría con los demás metodos, nuestra aplicación tendrá un manejo de autenticación un autorización un poco más organizado y mejor elaborado graciás a estás gemas.</p><p class="css-1ccrm8j">Si algó no está bien escrito o hay algun error pido disculpas, para dudas o comentarios estoy en las redes como @JoralmoPro.</p><p class="css-1ccrm8j">Para escribir este tutorial me he guidao y tal vez copiado algun trozo de código de <!-- --><a href="https://medium.com/@noordean/authentication-with-jwt-in-rails-api-71102387c0b0" class="css-1bw77fa">aquí</a>, <!-- --><a href="https://github.com/stalniy/rails-cancan-api-example" class="css-1bw77fa">aquí</a>, <!-- --><a href="https://github.com/CanCanCommunity/cancancan/wiki/exception-handling" class="css-1bw77fa">aquí</a>, <!-- --><a href="https://culttt.com/2016/01/20/implementing-roles-and-permissions-in-ruby-on-rails/" class="css-1bw77fa">aquí</a> y <!-- --><a href="https://riptutorial.com/ruby-on-rails/example/10259/getting-started-with-cancan" class="css-1bw77fa">aquí</a>.<!-- --></p><p class="css-1ccrm8j"><a href="https://gitlab.com/JoralmoPro/authrubyonrailstutorial" class="css-1bw77fa">Repositorio</a></p><blockquote class="css-1ioa6cd"><p class="css-1ccrm8j">¡Nos vemos el linea!</p></blockquote></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2023<!-- --> by <!-- -->JoralmoPro<!-- -->. All rights reserved.<!-- --></div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-1fmmdck">Theme</a> <!-- -->by<!-- --> <!-- --><a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-1fmmdck">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
    window.dev = undefined
    if (window.dev === true || !(navigator.doNotTrack === '1' || window.doNotTrack === '1')) {
      window._paq = window._paq || [];
      
      
      
      
      
      window._paq.push(['setTrackerUrl', 'https://joralmo.matomo.cloud//piwik.php']);
      window._paq.push(['setSiteId', '2']);
      window._paq.push(['enableHeartBeatTimer']);
      

      window.start = new Date();

      (function() {
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src='https://joralmo.matomo.cloud//piwik.js'; s.parentNode.insertBefore(g,s);
      })();

      if (window.dev === true) {
        console.debug('[Matomo] Tracking initialized')
        console.debug('[Matomo] matomoUrl: https://joralmo.matomo.cloud/, siteId: 2')
      }
    }
  </script><noscript><img src="https://joralmo.matomo.cloud//piwik.php?idsite=2&rec=1&url=https://blog.joralmo.pro//authentication-and-managing-roles-with-ruby-on-rails" style="border:0" alt="tracker" /></noscript><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/authentication-and-managing-roles-with-ruby-on-rails";window.___webpackCompilationHash="c2d5d75406b854f41ee9";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-167ad3a296625905496f.js"],"app":["/app-4e31211e15b33c3adf87.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-28aec58e9efe628e752b.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-635e99a00a125623cf43.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-98c6b26ca627a896782b.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-d5f544e16f00e92465c8.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-5c883d73e74623f891c5.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-c12681b9aa508b80c78c.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-5ca64c4fee0f20e2181b.js"]};/*]]>*/</script><script src="/polyfill-167ad3a296625905496f.js" nomodule=""></script><script src="/app-4e31211e15b33c3adf87.js" async=""></script><script src="/framework-ad7b141bba4afc6d1dfe.js" async=""></script><script src="/webpack-runtime-58958642f4ba800c17d7.js" async=""></script></body></html>